(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&s(n)}).observe(document,{childList:!0,subtree:!0});function e(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=e(i);fetch(i.href,o)}})();function I(r,t){return!(r.x+r.width<=t.x||t.x+t.width<=r.x||r.y+r.height<=t.y||t.y+t.height<=r.y)}function O(r,t){const e=Math.min(r.x,t.x),s=Math.min(r.y,t.y),i=Math.max(r.x+r.width,t.x+t.width),o=Math.max(r.y+r.height,t.y+t.height);return{x:e,y:s,width:i-e,height:o-s}}function V(r,t){const e=r.y===t.y&&r.height===t.height&&(r.x+r.width===t.x||t.x+t.width===r.x),s=r.x===t.x&&r.width===t.width&&(r.y+r.height===t.y||t.y+t.height===r.y);return e||s}class z{constructor(t=80,e=25){this.width=t,this.height=e,this.buffer=Array(e).fill(null).map(()=>Array(t).fill(null)),this.cursor={x:0,y:0,visible:!0,blinking:!0},this.dirtyRegions=[],this.batchRegions=[],this.batchMode=!1}writeChar(t,e,s,i){if(t<0||t>=this.width||e<0||e>=this.height)return;const o={char:s[0],attributes:i};this.buffer[e][t]=o,this.markDirty(t,e,1,1)}getChar(t,e){return t<0||t>=this.width||e<0||e>=this.height?null:this.buffer[e][t]}resize(t,e){const s=Array(e).fill(null).map(()=>Array(t).fill(null));for(let i=0;i<Math.min(e,this.height);i++)for(let o=0;o<Math.min(t,this.width);o++)s[i][o]=this.buffer[i][o];this.width=t,this.height=e,this.buffer=s,this.markDirty(0,0,t,e),this.cursor.x=Math.min(this.cursor.x,t-1),this.cursor.y=Math.min(this.cursor.y,e-1)}clear(){for(let t=0;t<this.height;t++)for(let e=0;e<this.width;e++)this.buffer[t][e]!==null&&this.markDirty(e,t,1,1);this.buffer=Array(this.height).fill(null).map(()=>Array(this.width).fill(null))}setCursorPosition(t,e){t<0||t>=this.width||e<0||e>=this.height||(this.markDirty(this.cursor.x,this.cursor.y,1,1),this.markDirty(t,e,1,1),this.cursor.x=t,this.cursor.y=e)}getCursorPosition(){return{x:this.cursor.x,y:this.cursor.y}}setCursorVisible(t){this.cursor.visible!==t&&(this.cursor.visible=t,this.markDirty(this.cursor.x,this.cursor.y,1,1))}setCursorBlinking(t){this.cursor.blinking!==t&&(this.cursor.blinking=t,this.markDirty(this.cursor.x,this.cursor.y,1,1))}beginBatch(){this.batchMode=!0,this.batchRegions=[]}endBatch(){this.batchMode=!1,this.batchRegions.length>0&&(this.optimizeAndAddRegions(this.batchRegions),this.batchRegions=[])}flush(){const t=[...this.dirtyRegions];return this.dirtyRegions=[],t}getBufferData(){if(this.cursor.visible&&this.cursor.blinking){const t=performance.now();(!this.cursor.lastBlinkTime||Math.floor(this.cursor.lastBlinkTime/500)!==Math.floor(t/500))&&(this.markDirty(this.cursor.x,this.cursor.y,1,1),this.cursor.lastBlinkTime=t)}return{width:this.width,height:this.height,cells:this.buffer,cursor:{...this.cursor}}}getDirtyRegions(){const t=[...this.dirtyRegions];return this.dirtyRegions=[],t}markDirty(t,e,s,i){const o={x:t,y:e,width:s,height:i};this.batchMode?this.batchRegions.push(o):this.optimizeAndAddRegions([o])}optimizeAndAddRegions(t){let e=[...this.dirtyRegions,...t],s=[],i;do{for(i=!1;e.length>0;){const o=e.pop();let n=!1;for(let h=0;h<s.length;h++)if(I(o,s[h])||V(o,s[h])){s[h]=O(o,s[h]),n=!0,i=!0;break}n||s.push(o)}i&&(e=s,s=[])}while(i);this.dirtyRegions=s}}const m=document.getElementById("screen"),c=m.getContext("2d"),f=80,p=25,u=9,d=16;m.width=f*u;m.height=p*d;const l=new z(f,p),C=["#000000","#0000aa","#00aa00","#00aaaa","#aa0000","#aa00aa","#aa5500","#aaaaaa","#555555","#5555ff","#55ff55","#55ffff","#ff5555","#ff55ff","#ffff55","#ffffff"];let w=performance.now(),x=0,M=0,B=0,a=0;const A="~≈≋≈~".split("");let g=!1,y=!0;const k=document.getElementById("pauseButton");k.addEventListener("click",()=>{g=!g,k.textContent=g?"Resume":"Pause",g||(w=performance.now(),requestAnimationFrame(R))});function P(){const{cells:r,cursor:t}=l.getBufferData();c.fillStyle="#000",c.fillRect(0,0,m.width,m.height);for(let e=0;e<p;e++)for(let s=0;s<f;s++){const i=r[e][s];i&&(c.fillStyle=C[i.attributes.background],c.fillRect(s*u,e*d,u,d),c.fillStyle=C[i.attributes.foreground],c.font="16px monospace",c.textBaseline="top",c.fillText(i.char,s*u,e*d))}if(t.visible){const e=Math.floor(performance.now()/500)%2;(t.blinking===!1||e===0)&&(c.fillStyle="#fff",c.fillRect(t.x*u,t.y*d,u,2))}}function H(){l.beginBatch(),l.clear();for(let n=0;n<p;n++)for(let h=0;h<f;h++){const D=Math.abs(h+a+Math.floor(Math.sin(n*.3)*3))%A.length,L=A[D]||"~",b=(h+n+a)%f/f,v=9+Math.floor(b*6),S=Math.floor(b*7),T={foreground:v,background:S,blink:!1};l.writeChar(h,n,L,T)}const r=Math.floor(f/2),t=Math.floor(p/2),e=5,s=a*.1%(Math.PI*2),i=r+Math.floor(Math.cos(s)*e),o=t+Math.floor(Math.sin(s)*e);l.setCursorPosition(i,o),l.endBatch(),a=(a+1)%1e3,M++}function R(r){g||(H(),P(),requestAnimationFrame(R)),x++,r-w>=1e3&&(document.getElementById("fps").textContent=x.toString(),document.getElementById("updates").textContent=(M-B).toString(),x=0,B=M,w=r)}const E=document.getElementById("cursorButton");E.addEventListener("click",()=>{y=!y,E.textContent=y?"Hide Cursor":"Show Cursor",l.setCursorVisible(y),P()});l.setCursorVisible(y);requestAnimationFrame(R);
